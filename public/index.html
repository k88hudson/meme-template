<!DOCTYPE html>
<html>
<head>
    <title>Basic template</title>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/popcorn.transitions.css">
    <link rel="stylesheet" href="css/fonts/digital-strip.css">
    <link rel="stylesheet" href="css/fonts/comic-fx.css">
    <link rel="stylesheet" href="css/fonts/Impact.css">
    <link rel="stylesheet" href="css/icons/glyphish_custom.css">
    <!--<link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css"/>-->
    <script src="https://browserid.org/include.js" type="text/javascript" data-butter-exclude></script>
    <script src="butter/src/butter.js" data-butter-exclude /></script>
     <script src="js/butter.template.js" data-butter-exclude /></script>
    <script type="text/javascript" src="main.js" data-butter-exclude /></script>
    <script src="js/libs/jquery-1.7.2.min.js"></script>
    <script src="js/libs/jquery-ui.min.js"></script>
    <script src="js/libs/jquery.fittext.js"></script>
    <script src="js/libs/mustache.js"></script>
    <style>
        /* EDITING */
        *[contenteditable=true] {
          background: rgba(252,234,56,.7);
          -webkit-transition: all .3s;
        }
        *[contenteditable=true]:focus{ outline: none;}

        .ui-resizable-handle { display: none; }
        .ui-resizable:hover .ui-resizable-handle {
          background: #EEE;
          background-position: -64px -224px;
          background-image: url(css/icons/ui-icons-blue.png);
        }
        .ui-resizable-handle {
          position: absolute;
          font-size: 0.1px;
          display: block;
          background: #EEE;
          background-image: url(css/icons/ui-icons.png);
          background: none;
          background-position: -64px -224px;
          }
        .ui-resizable-se {
          cursor: se-resize;
          width: 16px;
          height: 16px;
          right: -5px;
          bottom: -5px;
        }

         #help {
          display: none;
          font-family: sans-serif;
          padding: 10px;
          background: #F6DC7E;
          color: #E1182B;
        }

         #help ol, #help h3 {
          margin: .5em 0;
        }Ï€

        #mediabrowser {
          width: 400px;
          position: absolute;
          top: 50px;
          left: 400px;
          z-index: 5000;
          display: none;
        }

    </style>
</head>
<body>
    <div id="help" data-butter-exclude>
      <h3>Images:</h3>
      <ol>
        <li>Drag an image plugin from the tray to a target.</li>
        <li>Click and drag to move it around.</li>
        <li>Drop an image on it from your desktop.</li>
        <li>Try resizing it with the handle at the bottom right.</li>
      </ol>
      <h3>Zoinks</h3>
      <ol>
        <li>Click to drag.</li>
        <li>Double click to edit text.</li>
      </ol>
    </div>
    <div id="video-container" >
      <div id="video-overlay" data-butter="target"></div>
      <video id="main" data-butter="media" controls>
        <source src="butter/external/popcorn-js/test/trailer.ogv"></source>
        <source src="butter/external/popcorn-js/test/trailer.mp4"></source>
      </video>
    </div>

    <div id="mediabrowser">

<div id="main" class="widget">
  <div id="top-bar" class="widget-header label-text">
    <i class=".icon icon-archive"></i>
    <span>Moving images from archive.org</span>
  </div>
  <div id="tabs">
    <div id="searchresults" class="widget-body"></div>
    <div id="details" class="widget-body"></div>
  </div>
  <div id="search" class="widget-search">
    <input id="search-field" type="search" value="Search...">


<label><input type="checkbox" class="chan" value="channel:KGO OR channel:WMAR"> ABC</label>
<label><input type="checkbox" class="chan" value="channel:KPIX OR channel:WJZ OR channel:WUSA"> CBS</label>
<label><input type="checkbox" class="chan" value="channel:CNNW OR channel:CNN"> CNN</label>
<label><input type="checkbox" class="chan" value="channel:CSPAN OR channel:CSPAN2 OR channel:CSPAN3 OR channel:CSPN2"> CSPAN</label>
<label><input type="checkbox" class="chan" value="channel:COMW"> Comedy Central</label>
<label><input type="checkbox" class="chan" value="channel:KTVU OR channel:WBFF"> FOX</label>
<label><input type="checkbox" class="chan" value="channel:FOXNEWSW OR channel:FOXNEWS"> FOX News</label>
<label><input type="checkbox" class="chan" value="channel:MSNBCW OR channel:MSNBC"> MSNBC</label>
<label><input type="checkbox" class="chan" value="channel:KNTV"> NBC</label>
<label><input type="checkbox" class="chan" value="channel:KCSM OR channel:KQED OR channel:KRCB OR channel:KTEH OR channel:WMPT"> PBS</label>

     <button id="search-btn" class="btn dark btn-filetypes">Search!</button>
  </div>
</div>

<div id="searchresults-template" class="mustache-template">
{{#data}}
  <div id="box-{{index}}" class="box">
    <a href="#details-{{index}}" class="video-preview show-details"><img src="{{videoPoster}}" /></a>
    <p class="video-title">{{videoTitle}}</p>
    <p class="video-time">{{videoTime}}</p>
    <p class="video-description">{{videoDesc}}</p>
    <p class="date-uploaded">{{dateUploaded}}</p>
  </div>
{{/data}}
</div>

<div id="details-template" class="mustache-template">
  <div id="details-{{index}}" class="widget-details">
   <div class="full"><button class="close-me"><i class="icon icon-circlex"></i></button></div>
    <div class="third">
      <div class="video-preview">
        <a href="{{videoPreview}}" class="video-preview"><img src="{{videoPoster}}" /></a>
      </div>
      <p class="video-time">{{videoTime}}</p>
    </div>
    <div class="twothirds">
      <h3>{{videoTitle}}</h3>
      <div class="video-description">{{videoDesc}}</div>
      <div class="file-types">
        {{#fileTypes}}
          <button class="btn dark btn-filetypes" href="{{src}}">{{type}}</button>
        {{/fileTypes}}
      </div>
    </div>
    <div class="tags">
        <h4>Tags</h4>
        {{#tags}}
          <button class="btn btn-tags">{{name}}</button>
        {{/tags}}
      </div>
  </div>
</div>
</div>
<script>


$("#search-btn").click(function(){
  //TEMPLATE PARTS
//mainTemplate( featuredData );
  var url='http://archive.org/details/tv?output=json&callback=mainTemplate&pop=1&rows=9&q='+$('#search-field').val();
  $("#searchresults").addClass("active");
  //console.log(url);
  $.getScript(url, function(data){
    $(".video-description").each(function(i, item){
      var txt = $(item).html().replace(/\&lt;/g, '<').replace(/\&gt;/g, '>');
      $(item).html( txt );
    });
  });
});

var rawTest = "http://archive.org/details/CURRENT_20120201_010000_Countdown_With_Keith_Olbermann&start=27&end=57";

function mainTemplate( data ) {

  createTemplate( "searchresults-template", data, "searchresults" );
  $("#searchresults").addClass("active");

  //Show details
  $(".show-details").click(function(e){
    e.preventDefault();
    var videoID = $(this).attr("href"),
      videoData;
    //Real application uses ajax to retreive the data for that video.
                var idx=videoID.match(/\-(\d+)$/);
                idx=idx[1];
    videoData = data.data[idx]; //detailsData;
    createTemplate( "details-template", videoData, "details" );
    $( "#searchresults" ).removeClass("active");
    $( "#details" ).addClass("active"); 

    //Close me button
    $( "#details .close-me" ).click(function(e){
      e.preventDefault();
      $( "#details" ).removeClass("active");
      $( "#searchresults" ).addClass("active");
    });
  });
}

function createTemplate( templateID, data, targetID ) {
  var template = document.getElementById(templateID).innerHTML.replace(/%7B%7B/g, '{{').replace(/%7D%7D/g, '}}'),
    html = Mustache.render(template, data);
  document.getElementById(targetID).innerHTML = html;
}

</script>
</body>
</html>
